<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RestaurantController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">restaurant</a> &gt; <a href="index.source.html" class="el_package">com.food.restaurant.controller</a> &gt; <span class="el_source">RestaurantController.java</span></div><h1>RestaurantController.java</h1><pre class="source lang-java linenums">package com.food.restaurant.controller;

import com.food.restaurant.dto.CategoryOutDTO;
import com.food.restaurant.dto.FoodItemOutDTO;
import com.food.restaurant.dto.RestaurantDetailsDTO;
import com.food.restaurant.dto.RestaurantImageDTO;
import com.food.restaurant.dto.RestaurantInDTO;
import com.food.restaurant.dto.RestaurantOutDTO;
import com.food.restaurant.dto.RestaurantUpdateDTO;
import com.food.restaurant.service.RestaurantService;
import com.food.restaurant.util.MessageDTO;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RequestPart;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.multipart.MultipartFile;

import java.util.List;
/**
 * The RestaurantController class handles incoming HTTP requests related to
 * restaurant management, including creating, updating, deleting, and retrieving
 * restaurants, along with handling images and restaurant status.
 */
@RestController
@RequestMapping(&quot;/restaurants&quot;)
<span class="fc" id="L36">@Slf4j</span>
<span class="fc" id="L37">public class RestaurantController {</span>

  @Autowired
  private RestaurantService restaurantService;

  /**
   * Creates a new restaurant.
   *
   * @param restaurantInDto the restaurant data transfer object containing the restaurant's details.
   * @param image an optional image file for the restaurant.
   * @return ResponseEntity containing a message and HTTP status.
   */
  @PostMapping
  public ResponseEntity&lt;MessageDTO&gt; createRestaurant(
    @ModelAttribute RestaurantInDTO restaurantInDto,
    @RequestPart(value = &quot;image&quot;, required = false) MultipartFile image) {
<span class="fc" id="L53">    log.info(&quot;Received request to create restaurant with email: {}&quot;, restaurantInDto.getEmail());</span>
<span class="fc" id="L54">    return restaurantService.createRestaurant(restaurantInDto, image);</span>
  }

  /**
   * Updates an existing restaurant.
   *
   * @param id the ID of the restaurant to be updated.
   * @param restaurantUpdateDto the data transfer object containing the updated restaurant details.
   * @param image an optional image file to update the restaurant's image.
   * @return ResponseEntity containing a message and HTTP status.
   */
  @PutMapping(&quot;/{id}&quot;)
  public ResponseEntity&lt;MessageDTO&gt; updateRestaurant(
    @PathVariable Long id,
    @Validated @ModelAttribute RestaurantUpdateDTO restaurantUpdateDto,
    @RequestPart(value = &quot;image&quot;, required = false) MultipartFile image) {
<span class="nc" id="L70">    log.info(&quot;Received request to update restaurant with id: {} and email: {}&quot;, id, restaurantUpdateDto.getEmail());</span>
<span class="nc" id="L71">    return restaurantService.updateRestaurant(id, restaurantUpdateDto, image);</span>
  }

  /**
   * Deletes an existing restaurant.
   *
   * @param id the ID of the restaurant to be deleted.
   * @param ownerPassword the password of the restaurant owner for validation.
   * @return ResponseEntity containing a message and HTTP status.
   */
  @DeleteMapping(&quot;/{id}&quot;)
  public ResponseEntity&lt;MessageDTO&gt; deleteRestaurant(@PathVariable Long id, @RequestParam String ownerPassword) {
<span class="fc" id="L83">    log.info(&quot;Received request to delete restaurant with id: {} and owner password provided&quot;, id);</span>
<span class="fc" id="L84">    return restaurantService.deleteRestaurant(id, ownerPassword);</span>
  }

  /**
   * Retrieves the details of a restaurant by its ID.
   *
   * @param id the ID of the restaurant.
   * @return ResponseEntity containing restaurant details.
   */
  @GetMapping(&quot;/{id}&quot;)
  public ResponseEntity&lt;?&gt; getRestaurant(@PathVariable Long id) {
<span class="nc" id="L95">    log.info(&quot;Received request to get restaurant with id: {}&quot;, id);</span>
<span class="nc" id="L96">    return restaurantService.getRestaurant(id);</span>
  }

  /**
   * Retrieves a list of all restaurants.
   *
   * @return ResponseEntity containing a list of all restaurants.
   */
  @GetMapping
  public ResponseEntity&lt;List&lt;RestaurantOutDTO&gt;&gt; getAllRestaurants() {
<span class="nc" id="L106">    log.info(&quot;Received request to get all restaurants&quot;);</span>
<span class="nc" id="L107">    return restaurantService.getAllRestaurants();</span>
  }

  /**
   * Uploads an image for a specific restaurant.
   *
   * @param restaurantImageDTO the data transfer object containing the restaurant ID and the image file.
   * @return ResponseEntity containing a message and HTTP status.
   */
  @PostMapping(&quot;/upload-image&quot;)
  public ResponseEntity&lt;String&gt; uploadRestaurantImage(@ModelAttribute RestaurantImageDTO restaurantImageDTO) {
<span class="fc" id="L118">    log.info(&quot;Received request to upload image for restaurant with ID: {}&quot;, restaurantImageDTO.getRestaurantId());</span>
<span class="fc" id="L119">    return restaurantService.uploadRestaurantImage(restaurantImageDTO);</span>
  }

  /**
   * Retrieves the image of a specific restaurant by its ID.
   *
   * @param restaurantId the ID of the restaurant.
   * @return ResponseEntity containing the restaurant image as a byte array.
   */
  @GetMapping(&quot;/{restaurantId}/image&quot;)
  public ResponseEntity&lt;byte[]&gt; getRestaurantImage(@PathVariable Long restaurantId) {
<span class="fc" id="L130">    log.info(&quot;Received request to get image for restaurant with ID: {}&quot;, restaurantId);</span>
<span class="fc" id="L131">    return restaurantService.getRestaurantImage(restaurantId);</span>
  }

  /**
   * Updates the image of a specific restaurant.
   *
   * @param restaurantImageDTO the data transfer object containing the restaurant ID and the new image.
   * @return ResponseEntity containing a message and HTTP status.
   */
  @PutMapping(&quot;/{restaurantId}/image&quot;)
  public ResponseEntity&lt;MessageDTO&gt; updateRestaurantImage(@ModelAttribute RestaurantImageDTO restaurantImageDTO) {
<span class="fc" id="L142">    log.info(&quot;Received request to update image for restaurant with ID: {}&quot;, restaurantImageDTO.getRestaurantId());</span>
<span class="fc" id="L143">    return restaurantService.updateRestaurantImage(restaurantImageDTO);</span>
  }

  /**
   * Deletes the image of a specific restaurant.
   *
   * @param restaurantId the ID of the restaurant.
   * @return ResponseEntity containing a message and HTTP status.
   */
  @DeleteMapping(&quot;/{restaurantId}/image&quot;)
  public ResponseEntity&lt;String&gt; deleteRestaurantImage(@PathVariable Long restaurantId) {
<span class="fc" id="L154">    log.info(&quot;Received request to delete image for restaurant with ID: {}&quot;, restaurantId);</span>
<span class="fc" id="L155">    return restaurantService.deleteRestaurantImage(restaurantId);</span>
  }

  /**
   * Sets the open status of a specific restaurant.
   *
   * @param id the ID of the restaurant.
   * @param isOpen the open status to be set (true or false).
   * @return ResponseEntity containing a message and HTTP status.
   */
  @PutMapping(&quot;/{id}/open-status&quot;)
  public ResponseEntity&lt;MessageDTO&gt; setRestaurantStatus(@PathVariable Long id, @RequestParam Boolean isOpen) {
<span class="fc" id="L167">    log.info(&quot;Received request to set restaurant status with id: {} to isOpen: {}&quot;, id, isOpen);</span>
<span class="fc" id="L168">    return restaurantService.setRestaurantStatus(id, isOpen);</span>
  }

  /**
   * Retrieves all categories and their food items for a specific restaurant.
   *
   * @param restaurantId the ID of the restaurant.
   * @return ResponseEntity containing a list of categories and their food items.
   */
  @GetMapping(&quot;/{restaurantId}/categories/food-items&quot;)
  public ResponseEntity&lt;List&lt;CategoryOutDTO&gt;&gt; getAllFoodItemsByRestaurant(@PathVariable Long restaurantId) {
<span class="fc" id="L179">    log.info(&quot;Received request to fetch all categories and their food items for restaurant ID: {}&quot;, restaurantId);</span>
<span class="fc" id="L180">    return restaurantService.getAllFoodItemsByRestaurant(restaurantId);</span>
  }

  /**
   * Retrieves all food items for a specific restaurant.
   *
   * @param restaurantId the ID of the restaurant.
   * @return ResponseEntity containing a list of food items.
   */
  @GetMapping(&quot;/{restaurantId}/food-items&quot;)
  public ResponseEntity&lt;List&lt;FoodItemOutDTO&gt;&gt; getAllFoodItemsOfRestaurant(@PathVariable Long restaurantId) {
<span class="fc" id="L191">    log.info(&quot;Received request to fetch all food items for restaurant ID: {}&quot;, restaurantId);</span>
<span class="fc" id="L192">    return restaurantService.getAllFoodItemsOfRestaurant(restaurantId);</span>
  }

  /**
   * Retrieves all restaurants along with their categories and food items.
   *
   * @return ResponseEntity containing a list of all restaurants with their details.
   */
  @GetMapping(&quot;/all-details&quot;)
  public ResponseEntity&lt;List&lt;RestaurantDetailsDTO&gt;&gt; getAllRestaurantsWithDetails() {
<span class="fc" id="L202">    log.info(&quot;Received request to get all restaurants with their categories and food items&quot;);</span>
<span class="fc" id="L203">    return restaurantService.getAllRestaurantsWithDetails();</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>