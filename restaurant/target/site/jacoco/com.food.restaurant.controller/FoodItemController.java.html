<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FoodItemController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">restaurant</a> &gt; <a href="index.source.html" class="el_package">com.food.restaurant.controller</a> &gt; <span class="el_source">FoodItemController.java</span></div><h1>FoodItemController.java</h1><pre class="source lang-java linenums">package com.food.restaurant.controller;

import com.food.restaurant.dto.FoodItemImageDTO;
import com.food.restaurant.dto.FoodItemInDTO;
import com.food.restaurant.dto.FoodItemOutDTO;
import com.food.restaurant.service.FoodItemService;
import com.food.restaurant.util.MessageDTO;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RequestPart;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.multipart.MultipartFile;

import java.util.List;

/**
 * The {@code FoodItemController} class handles HTTP requests related to food items,
 * including creation, updating, deletion, retrieval, and image management.
 */
@RestController
@RequestMapping(&quot;/food-items&quot;)
<span class="fc" id="L32">@Slf4j</span>
<span class="fc" id="L33">public class FoodItemController {</span>

  @Autowired
  private FoodItemService foodItemService;

  /**
   * Creates a new food item.
   *
   * @param foodItemInDTO the DTO containing food item details
   * @param image         the image file for the food item (optional)
   * @return a {@link ResponseEntity} with a message indicating success or failure
   */
  @PostMapping
  public ResponseEntity&lt;MessageDTO&gt; createFoodItem(@Validated @ModelAttribute FoodItemInDTO foodItemInDTO,
                                                   @RequestPart(value = &quot;image&quot;, required = false)
                                                   MultipartFile image) {
<span class="fc" id="L49">    log.info(&quot;Received request to create food item for restaurant ID: {}&quot;, foodItemInDTO.getRestaurantId());</span>
<span class="fc" id="L50">    return foodItemService.createFoodItem(foodItemInDTO, image);</span>
  }

  /**
   * Retrieves all food items for a given category.
   *
   * @param categoryId the ID of the category
   * @return a {@link ResponseEntity} with a list of food items for the specified category
   */
  @GetMapping(&quot;/category/{categoryId}&quot;)
  public ResponseEntity&lt;List&lt;FoodItemOutDTO&gt;&gt; getAllFoodItems(@PathVariable Long categoryId) {
<span class="fc" id="L61">    log.info(&quot;Received request to get all food items for category ID: {}&quot;, categoryId);</span>
<span class="fc" id="L62">    return foodItemService.getAllFoodItemsForCategory(categoryId);</span>
  }

  /**
   * Updates a food item by its ID.
   *
   * @param id            the ID of the food item to update
   * @param foodItemInDTO the DTO containing updated food item details
   * @param image         the new image file for the food item (optional)
   * @return a {@link ResponseEntity} with a message indicating success or failure
   */
  @PutMapping(&quot;/{id}&quot;)
  public ResponseEntity&lt;MessageDTO&gt; updateFoodItem(
    @PathVariable Long id,
    @Validated @ModelAttribute FoodItemInDTO foodItemInDTO,
    @RequestParam(value = &quot;image&quot;, required = false) MultipartFile image) {
<span class="nc" id="L78">    log.info(&quot;Received request to update food item with ID: {}&quot;, id);</span>
<span class="nc" id="L79">    return foodItemService.updateFoodItem(id, foodItemInDTO, image);</span>
  }

  /**
   * Deletes a food item by its ID.
   *
   * @param id the ID of the food item to delete
   * @return a {@link ResponseEntity} with a message indicating success or failure
   */
  @DeleteMapping(&quot;/{id}&quot;)
  public ResponseEntity&lt;MessageDTO&gt; deleteFoodItem(@PathVariable Long id) {
<span class="fc" id="L90">    log.info(&quot;Received request to delete food item with ID: {}&quot;, id);</span>
<span class="fc" id="L91">    return foodItemService.deleteFoodItem(id);</span>
  }

  /**
   * Uploads an image for a food item.
   *
   * @param foodItemImageDTO the DTO containing the food item ID and image file
   * @return a {@link ResponseEntity} with a success message
   */
  @PostMapping(&quot;/upload-image&quot;)
  public ResponseEntity&lt;String&gt; uploadFoodItemImage(@ModelAttribute FoodItemImageDTO foodItemImageDTO) {
<span class="fc" id="L102">    log.info(&quot;Received request to upload image for food item ID: {}&quot;, foodItemImageDTO.getFoodItemId());</span>
<span class="fc" id="L103">    return foodItemService.uploadFoodItemImage(foodItemImageDTO);</span>
  }

  /**
   * Retrieves the image for a food item by its ID.
   *
   * @param foodItemId the ID of the food item
   * @return a {@link ResponseEntity} containing the image as a byte array
   */
  @GetMapping(&quot;/{foodItemId}/image&quot;)
  public ResponseEntity&lt;byte[]&gt; getFoodItemImage(@PathVariable Long foodItemId) {
<span class="fc" id="L114">    log.info(&quot;Received request to get image for food item ID: {}&quot;, foodItemId);</span>
<span class="fc" id="L115">    return foodItemService.getFoodItemImage(foodItemId);</span>
  }

  /**
   * Updates the image for a food item.
   *
   * @param foodItemImageDTO the DTO containing the food item ID and new image file
   * @return a {@link ResponseEntity} with a message indicating success or failure
   */
  @PutMapping(&quot;/{foodItemId}/image&quot;)
  public ResponseEntity&lt;MessageDTO&gt; updateFoodItemImage(@ModelAttribute FoodItemImageDTO foodItemImageDTO) {
<span class="fc" id="L126">    log.info(&quot;Received request to update image for food item ID: {}&quot;, foodItemImageDTO.getFoodItemId());</span>
<span class="fc" id="L127">    return foodItemService.updateFoodItemImage(foodItemImageDTO);</span>
  }

  /**
   * Deletes the image for a food item by its ID.
   *
   * @param foodItemId the ID of the food item
   * @return a {@link ResponseEntity} with a message indicating success or failure
   */
  @DeleteMapping(&quot;/{foodItemId}/image&quot;)
  public ResponseEntity&lt;MessageDTO&gt; deleteFoodItemImage(@PathVariable Long foodItemId) {
<span class="fc" id="L138">    log.info(&quot;Received request to delete image for food item ID: {}&quot;, foodItemId);</span>
<span class="fc" id="L139">    return foodItemService.deleteFoodItemImage(foodItemId);</span>
  }

  /**
   * Retrieves food items sorted by price in ascending or descending order.
   *
   * @param ascending whether the items should be sorted in ascending (true) or descending (false) order
   * @return a {@link ResponseEntity} with a list of sorted food items
   */
  @GetMapping(&quot;/sort&quot;)
  public ResponseEntity&lt;List&lt;FoodItemOutDTO&gt;&gt; getFoodItemsSortedByPrice(
    @RequestParam(name = &quot;asc&quot;, defaultValue = &quot;true&quot;) boolean ascending) {
<span class="pc bpc" id="L151" title="1 of 2 branches missed.">    log.info(&quot;Received request to get food items sorted by price in {} order&quot;, ascending ? &quot;ascending&quot; : &quot;descending&quot;);</span>
<span class="fc" id="L152">    return foodItemService.getFoodItemsSortedByPrice(ascending);</span>
  }

  /**
   * Filters food items by availability.
   *
   * @param availability the availability status to filter by
   * @return a {@link ResponseEntity} with a list of food items matching the availability status
   */
  @GetMapping(&quot;/filter/availability&quot;)
  public ResponseEntity&lt;List&lt;FoodItemOutDTO&gt;&gt; filterByAvailability(@RequestParam boolean availability) {
<span class="fc" id="L163">    log.info(&quot;Received request to filter food items by availability: {}&quot;, availability);</span>
<span class="fc" id="L164">    return foodItemService.filterByAvailability(availability);</span>
  }

  /**
   * Filters food items by vegetarian status.
   *
   * @param isVeg the vegetarian status to filter by
   * @return a {@link ResponseEntity} with a list of food items matching the vegetarian status
   */
  @GetMapping(&quot;/filter/is-veg&quot;)
  public ResponseEntity&lt;List&lt;FoodItemOutDTO&gt;&gt; filterByIsVeg(@RequestParam boolean isVeg) {
<span class="fc" id="L175">    log.info(&quot;Received request to filter food items by vegetarian status: {}&quot;, isVeg);</span>
<span class="fc" id="L176">    return foodItemService.filterByIsVeg(isVeg);</span>
  }

  /**
   * Filters food items by category name.
   *
   * @param categoryName the name of the category to filter by
   * @return a {@link ResponseEntity} with a list of food items matching the category name
   */
  @GetMapping(&quot;/filter/category&quot;)
  public ResponseEntity&lt;List&lt;FoodItemOutDTO&gt;&gt; filterByCategoryName(@RequestParam String categoryName) {
<span class="fc" id="L187">    log.info(&quot;Received request to filter food items by category name: {}&quot;, categoryName);</span>
<span class="fc" id="L188">    return foodItemService.filterByCategoryName(categoryName);</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>